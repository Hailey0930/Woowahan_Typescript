# 타입스크립트 마이그레이션

## 타입스크립트 마이그레이션의 필요성

타입스크립트를 새로운 기술 스택으로 도입하는 결정을 했더라도 반드시 기존 프로젝트를 타입스크립트로 마이그레이션해야만 하는 것은 아니다. 우아한형제들에서는 타입스크립트로 프로젝트를 새로 구축한 사례가 기존 자바스크립트 프로젝트를 타입스크립트로 마이그레이션한 사례보다 많다. 아마도 새로운 설계를 바탕으로 타입을 작성하는 게 더 효율적이었기 때문일 것이다.

빠르게 변화하는 비즈니스 환경에서는 기존 코드의 구조적인 한계가 드러날 수 있다. 이런 상황에서 자바스크립트 코드를 타입스크립트 코드로 변환하는 것은 현재 비즈니스 로직에 맞지 않는 인터페이스만 추가하는 작업에 불과할 수도 있다. 이런 작업은 마이그레이션 과정 자체에 대한 의구심을 불러일으킬 수 있으며, 타입스크립트 코드로 성공적으로 변환을 마치더라도 타입스크립트의 장점을 충분히 활용하기 어려울 수 있다.

따라서 상황에 따라 비즈니스 요구 사항의 변화를 반영할 수 있는 새로운 설계를 기반으로 타입을 작성하는 게 효율적일 수 있다. 프로젝트의 규모와 특성 및 내외부 여건을 종합적으로 고려하여, 기존 프로젝트를 신규 프로젝트로 바꾸는게 나을지 단순히 마이그레이션하는게 나을지를 신중하게 따져봐야 한다.

## 점진적인 마이그레이션

정말 작은 프로젝트가 아닌 이상, 하루아침에 전체 마이그레이션을 완료할 수는 없을 것이다. 따라서 작은 부분부터 시작하여 점차 범위를 넓혀가며 마이그레이션을 진행하게 된다. 이런 식으로 타입스크립트 마이그레이션을 점진적으로 진행할 수 있다면 참으로 다행이다. 작은 부분부터 마이그레이션을 시작할 수 있기 때문에 진입 장벽이 낮아지고 프로젝트의 전반적인 동작을 안정적으로 유지할 수 있게 된다.

하지만 단순히 allowJS를 true, noImplicitAny를 false로 설정한 채 무기한으로 마이그레이션을 미루는 것은 지양해야 한다. 데드라인이 없는 프로젝트는 언제 완료될지 모르는 과도기에 빠질 수 있다. 따라서 점진적인 타입스크립트 마이그레이션을 진행하기로 했다면, 프로젝트 참여자와 함께 우선순위를 대략적이라도 설정해두는 게 좋다.

## 마이그레이션 진행하기

타입스크립트 마이그레이션을 진행하기로 했다면 다음과 같은 단계를 거치게 된다.

1. 타입스크립트 개발 환경을 설정하고, 빌드 파이프라인에 타입스크립트 컴파일러를 통합한다. tsconfig.json 파일에서 allowJS를 true로 noImplicitAny를 false로 설정해야 한다.<br />
   allowJS(기본값: false)는 자바스크립트 파일을 컴파일할 때 사용하는 옵션으로, 기존 자바스크립트 함수를 타입스크립트에서 임포트하거나 반대로 타입스크립트 함수를 자바스크립트에서 임포트할 수 있게 해준다.<br />
   또한 noImplicitAny는 암시적 any 타입이 있을 때 오류가 발생하게 하는 옵션이다. 따라서 타입을 점진적으로 추가하는 과정에서는 오류가 발생하지 않도록 noImplicitAny를 false로 설정해야 한다.
2. 작성된 자바스크립트 파일을 타입스크립트 파일로 변환한다. 이 단계에서는 필요한 타입과 인터페이스를 하나씩 정의하며 함수 시그니처를 추가해나간다.
3. 기존 자바스크립트 파일을 모두 타입스크립트로 변환하는 작업이 완료되었다면 tsconfig.json 파일에서 allowJS를 false로 변경하고, noImplicitAny를 true로 설정하여 타입이 명시되지 않은 부분이 없는지 점검한다.
